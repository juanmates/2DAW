<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script>
      // Variable para almacenar la referencia de la ventana emergente
      var ventanaEmergente;

      // Función que abre la ventana emergente y configura el temporizador
      function abrirVentana() {
        // Si la ventana ya está abierta, no abrir otra
        if (ventanaEmergente && !ventanaEmergente.closed) {
          alert("La ventana emergente ya está abierta.");
          return;
        }

        // Abrir la nueva ventana emergente
        ventanaEmergente = window.open("", "ventana", "width=400,height=200");

        // Escribir contenido en la ventana emergente
        ventanaEmergente.document.write(
          "<h2>Esta ventana se cerrará automáticamente en 10 segundos.</h2>"
        );

        // Tiempo inicial para la cuenta regresiva
        let tiempoRestante = 10;

        // Mostrar el temporizador en la ventana principal
        document.getElementById("temporizador").innerHTML =
          "La ventana se cerrará en " + tiempoRestante + " segundos.";

        let intervalo = setInterval(restar, 1000);

        function restar() {
          tiempoRestante--;
          document.getElementById("temporizador").innerHTML =
            "La ventana se cerrará en " + tiempoRestante + " segundos.";

          // Si llega a 0, cerrar la ventana emergente y detener el intervalo
          if (tiempoRestante === 0) {
            ventanaEmergente.close();
            clearInterval(intervalo);
            document.getElementById("temporizador").innerHTML =
              "La ventana se ha cerrado.";
          }
        }

        // Configurar un temporizador que actualiza cada segundo
        /* Otra forma:
        
        let intervalo = setInterval(function () {
          tiempoRestante--;
          document.getElementById("temporizador").innerHTML =
            "La ventana se cerrará en " + tiempoRestante + " segundos.";

          // Si llega a 0, cerrar la ventana emergente y detener el intervalo
          if (tiempoRestante === 0) {
            ventanaEmergente.close();
            clearInterval(intervalo);
            document.getElementById("temporizador").innerHTML =
              "La ventana se ha cerrado.";
          }
        }, 1000);*/
      }
    </script>
  </head>
  <body>
    <h1>Ejercicio de Ventanas y Temporizadores</h1>
    <p>
      Haz clic en el botón para abrir una ventana emergente que se cerrará
      automáticamente en 10 segundos.
    </p>

    <button onclick="abrirVentana()">Abrir Ventana Emergente</button>

    <p id="temporizador"></p>
    <!-- Aquí se mostrará el temporizador -->
  </body>
</html>
